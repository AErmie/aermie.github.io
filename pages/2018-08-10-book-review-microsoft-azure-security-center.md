---
layout: page
title: Book Review: Microsoft Azure Security Center
date: 2018-08-10 10:09
author: AdinErmie
comments: true
categories: []
---
<!-- wp:image {"id":31451,"align":"left"} -->
<figure class="wp-block-image alignleft"><img src="/wp-content/uploads/2018/08/MicrosoftSecurityCenterBook_Cover-244x300.jpg" alt="" class="wp-image-31451"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Recently, I finished reading the <a href="https://www.microsoftpressstore.com/store/microsoft-azure-security-center-9781509307036" target="_blank" rel="noreferrer noopener">Microsoft Azure Security Center</a> book. </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>What I appreciated about the book is that it didn't just cover the high-level surface items. It went into detail about how Azure Security Center operates, integrates and feeds from other data sources, etc. </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>It even walks through a security investigation scenario, so that you can see how/when/where you would use Azure Security Center. </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>I’ve decided to share my highlights from reading this specific publication, in case the points that I found of note/interest will be of some benefit to someone else. So, here are my highlights (by chapter). Note that not every chapter will have highlights (depending on the content and the main focus of my work).</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2>Chapter 1: The <g class="gr_ gr_3 gr-alert sel gr_spell gr_replaced gr_inline_cards gr_disable_anim_appear ContextualSpelling ins-del" id="3" data-gr-id="3">Threat</g> Landscape</h2>
<!-- /wp:heading -->

<!-- wp:list -->
<ul><li>Collecting data without analyzing it only delays the response process. That’s why it is so important to use tools that leverage technologies such as behavior analytics, threat intelligence, and machine learning for data correlation. </li><li>Before adopting cloud computing, organizations must understand the security concerns inherent in the cloud-computing model. </li><li>Organizations planning to adopt cloud computing must be aware of the identity- and access management methods available and of how these methods will integrate with their current on-premises infrastructure. </li><li>Organizations migrating to the cloud should evolve their internal processes, such as security monitoring, auditing, incident response, and forensics, accordingly. </li><li>IMPORTANT Securing privileged access is a critical step to establishing security as surances for business. Make sure to read more about Privileged Access Workstations at <a href="http://aka.ms/cyberpaw" target="_blank" rel="noopener">http://aka.ms/cyberpaw</a> and know more about Microsoft’s methodology for protecting high-value assets.</li><li>The Azure infrastructure uses a defense-in-depth approach by implementing security controls in different layers. This ranges from physical security, to data security, to identity and access management, and to application security. </li><li>One way to enforce network access controls in Azure is by taking advantage of NSGs. An NSG is equivalent to a simple stateful packet-filtering firewall or router, similar to the type of firewalling done in the 1990s. (I say this not to be negative about NSGs, but to make it clear that some techniques for network access control have survived the test of time.)</li><li>Azure Storage automatically encrypts the data prior to persisting to storage and decrypts it prior to retrieval. </li><li>By applying Azure’s massive computing, storage, and machine-learning capabilities to the problem of better securing our custom<br/>ers, Microsoft has developed a security intelligence service based on security signals that we receive from myriad sources—Office 365, Microsoft Account (formerly Windows Live ID), the Digital Crimes Unit, and the Azure cloud platform itself.</li><li>Imagine having an army of security analysts working day and night to research emerging cybersecurity threats and identify actual instances of malicious behaviors targeting your Azure resources so that you can respond and protect your critical assets in a rapid manner. With ASC, you’re not imagining it—you have that capability built right into the service, with no additional work needed on your part.<br/></li></ul>
<!-- /wp:list -->

<!-- wp:heading -->
<h2>Chapter 2: Introduction To Azure Security Center</h2>
<!-- /wp:heading -->

<!-- wp:list -->
<ul><li>Security Center uses machine-learning technologies to evaluate all relevant events across the entire cloud fabric. </li><li>IMPORTANT Only subscription owners or contributors and security admins can edit a security policy. Only subscription and resource group owners and contributors can apply security recommendations for a resource. </li><li>Before you adopt <g class="gr_ gr_66 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Grammar only-ins replaceWithoutSep" id="66" data-gr-id="66">Security</g> Center, you should fully address all existing recommendations. Although this is not a prerequisite, it is a good practice. </li><li>Here are a few key points for incorporating Security Center into your security operations: <ul><li>Security Center will continuously evaluate compute, network, storage, and application resources for compliance. The team responsible for ongoing security assessment should track and apply recommendations issued by <g class="gr_ gr_119 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Grammar only-ins replaceWithoutSep" id="119" data-gr-id="119">Security</g> Center on an ongoing basis.<br/></li><li>The security roles available in Security Center, along with Azure’s RBAC capability, can help SOC management control who has access to what. <br/></li><li>Security Center can integrate with Power BI to create reports and graphs when <g class="gr_ gr_239 gr-alert gr_gramm gr_inline_cards gr_run_anim Grammar only-ins doubleReplace replaceWithoutSep" id="239" data-gr-id="239">more</g> detailed analysis is needed.<br/></li><li>The incident response (IR) team can use security alerts and incident features during the detection and triage phases of an attack to conduct early assessments of the incident. If more in-depth research on an attack is needed, the team can use Security Center’s investigation and search features. Finally, when the team is ready to respond, it can use the Security Playbook feature to customize a response to a certain alert.</li></ul></li><li>IMPORTANT A security assessment conducted on VMs will also look for the presence of a security configuration based on Common Configuration Enumeration (CCE) rules. To download these rules, visit <a href="https://aka.ms/ascccerules" target="_blank">https://aka.ms/ascccerules</a>. <br/></li></ul>
<!-- /wp:list -->

<!-- wp:heading -->
<h2>Chapter 3: Policy Management</h2>
<!-- /wp:heading -->

<!-- wp:list -->
<ul><li>TIP If you choose to put Security Center data into an existing workspace that already has connected solutions, monitor your costs closely. </li><li>When you configure policy here—whether it’s a protection policy, a detection policy, a response policy, or what have you—you’re simply telling Security Center what you want recommendations for. That’s it. There’s no “leveling” of policy—for example, high versus medium versus low—and there’s no hierarchy. It’s just a “what do you want us to look at” type of policy.</li><li>Security Center uses your input in this blade to create a series of recommendations for you. It’s like having a cybersecurity expert review your configuration and provide recommendations that you can use to significantly enhance the security of your deployment. </li><li>To get an idea of the baselines against which these VAs are compared, see <a href="https://gallery.technet.microsoft.com/Azure-Security-Center-a789e335" target="_blank" rel="noopener">https://gallery.technet.microsoft.com/Azure-Security-Center-a789e335</a>. </li><li>A network security group (NSG) is essentially a basic stateful packet filter that enables you to control inbound and outbound traffic based on a 5-tuple. It is not application layer–aware.</li><li>There may be times when incoming and outgoing connections of VMs and subnets use protocols other than web protocols. If so, Security Center will recommend you use something more robust than a basic WAF: a Next-Generation Firewall (NGFW). NGFWs can perform numerous sophisticated application-layer inspections, as well as protocol validation and intrusion detection and prevention. </li><li>Microsoft considers these events—including login and logout events—to provide sufficient detail to represent a reasonable audit trail. Other events, such as Kerberos operations, security group changes, and more, are included based on industry consensus as to what constitutes a full audit trail. </li><li>NOTE The key to success here is to understand the difference between Minimal and Common. We suggest you test both configurations to see which one meets your needs.</li><li>Data Collection ('None') This setting doesn’t really mean none—more like almost none. When you enable this option, your security dashboards in Security Center will contain information drawn from Windows firewall logs and from source assessments done by antimalware, baseline assessments, and update evaluations. It includes no security alerts and no information from the operating system logs or App Locker logs. </li><li>Be certain, however, that any email addresses you include are secured with two-factor authentication. Information shared in these email notifications may contain confidential information, and you want to minimize your risk and exposure. <br/></li></ul>
<!-- /wp:list -->

<!-- wp:heading -->
<h2><g class="gr_ gr_3 gr-alert sel gr_spell gr_replaced gr_inline_cards gr_disable_anim_appear ContextualSpelling ins-del multiReplace" id="3" data-gr-id="3">Chapter</g> 4: Mitigating Security Issues</h2>
<!-- /wp:heading -->

<!-- wp:list -->
<ul><li>After you enable Storage Encryption, only new data will be encrypted. Any existing files in this storage account will remain unencrypted. Once encryption is enabled, it cannot be disabled.<br/></li></ul>
<!-- /wp:list -->

<!-- wp:heading -->
<h2>Chapter 5: Using Security Center For Incident Response</h2>
<!-- /wp:heading -->

<!-- wp:list -->
<ul><li>IMPORTANT Security alerts are not available in the free tier version of Security Center; the standard tier is required. </li><li>The security analytics include data from multiple sources, including Microsoft products and services, the Microsoft Digital Crimes Unit (DCU), the Microsoft Security Response Center (MSRC), and external feeds. </li><li>Security Center uses statistical profiling to build a historical baseline. </li><li>The detection engine collects data from multiple data sources including but not limited to endpoint logs, network traffic, and cloud services activity, and applies atomic, behavioral, and machine learning-based logic to detect active threats. </li><li>Security playbooks enable you to create a collection of procedures that can be executed from <g class="gr_ gr_76 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Grammar only-ins replaceWithoutSep" id="76" data-gr-id="76">Security</g> Center when a certain security alert is triggered. Azure Logic Apps is the automation mechanism behind security playbooks. </li><li>Before creating a playbook, you should have in mind what you want to automate. Before implementing this feature, answer the following questions: <ul><li>For which security alert should I automate a response?</li><li>What steps should be automated if the conditions for this alert are true?</li><li>What steps should be automated if the conditions for this alert are false? </li></ul></li><li>TIP The following presentation, delivered by co-author Yuri Diogenes at Ignite 2017, shows how to integrate playbook with Slack: <a href="https://youtu.be/e8iFCz5RM4g" target="_blank">https://youtu.be/e8iFCz5RM4g</a><br/></li></ul>
<!-- /wp:list -->

<!-- wp:heading -->
<h2>Chapter 6: Advanced Cloud Defense</h2>
<!-- /wp:heading -->

<!-- wp:list -->
<ul><li>When you use behavioral analysis, you are not concerned with how the attacker accomplishes his or her tasks. You’re more interested in the behavior that caused the attacker’s actions. </li><li>To help prevent alert fatigue, Azure Security Center might not immediately generate an alert in a case like the one described here. Instead, it will note the behavior and, if some other event occurs that can be correlated with the behavior, generate a fusion alert. </li><li>Azure Security Center uses machine-learning algorithms on data collected by its agents (for example, security events and network traffic logs) to recommend tailored security policies (for example, application control rules) to its customers. </li><li>Azure Security Center creates baselines for VMs across an array of parameters that have been deemed useful for determining the current security state. The parameters used, and the details of how baselines are configured and <g class="gr_ gr_158 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Punctuation only-del replaceWithoutSep" id="158" data-gr-id="158">calculated,</g> is a trade secret—one of the many “secret sauces” that make Azure Security Center today’s superior security solution. However, we can tell you that for most of your VMs, the baseline period will be 30 days—although, again, this will vary. </li><li>Not all anomalies are security issues, but all security issues are anomalies (unless your security architecture and implementation <g class="gr_ gr_267 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Grammar multiReplace" id="267" data-gr-id="267">is</g> so bad that security events are the norm in your environment—in which case you have problems that must be addressed well before you attempt to leverage the subtle power of anomaly detection). </li><li>Azure Security Center examines processes running on the VMs in your resource groups, develops a list of allow rules, and surfaces the list as a recommendation that you can choose to accept or reject. </li><li>NOTE Be prepared to receive a lot of these recommendations, as each recommendation refers to a single process or file. You can choose to accept all <g class="gr_ gr_359 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Grammar only-ins replaceWithoutSep" id="359" data-gr-id="359">recommendations</g> in the list, some but not all of the recommendations, or just one. </li><li>NOTE To learn more about application whitelisting (adaptive application controls), check out the article “Adaptive Application Controls in Azure Security Center” at <a href="https://docs.microsoft.com/en-us/azure/security-center/security-center-adaptive-application" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/azure/security-center/security-center-adaptive-application</a>.</li><li>The only times we do not recommend using JIT are when no existing NSG is associated with the VM or when the VM is a classic VM. </li><li>Sometimes, when a VM might be a candidate for JIT VM access, Azure Security Center doesn’t issue a recommendation to that effect. This occurs when the JIT solution is disabled via a security policy set at the subscription or resource-group level, when the VM doesn’t have a public IP address, and when the VM is not associated with an NSG. </li><li>When users request JIT access, Azure Security Center checks their RBAC permissions. If the user <g class="gr_ gr_518 gr-alert gr_gramm gr_inline_cards gr_disable_anim_appear Grammar only-ins replaceWithoutSep" id="518" data-gr-id="518">has</g> write access to the VM, JIT access will be granted. At that point, Azure Security Center will dynamically create NSG rules to allow inbound management traffic. When JIT access expires, the NSG rules will be removed. Note that connections are not actively reset, so a user who is connected will remain so until the connection is dropped by the user or for some other reason. <br/></li></ul>
<!-- /wp:list -->

<!-- wp:heading -->
<h2>Chapter 7: Security Incident and Event Management (SIEM) Integration With Splunk</h2>
<!-- /wp:heading -->

<!-- wp:list -->
<ul><li>Azure Monitor operates at enterprise cloud scale and simplifies the management of routing log data into SIEMs using a single schema and access point across all Azure services. This dramatically simplifies Azure log integration with SIEM tools and includes the alerts available from Azure Security Center. Azure Monitor is Azure’s central logging pipeline going forward and provides several out-of-the-box integrations with popular SIEM tools such as Splunk and IBM QRadar.</li><li>Azure Security Center alerts are published to the Azure activity log. Azure activity logs are considered data plane–level logs, which separates them from Azure diagnostic logs (which allow you to get insight into services and troubleshoot those services).</li><li>IMPORTANT Be aware that the SIEM must be configured on a per-subscription basis, so each subscription that has data to transmit to the SIEM will need to be configure manually.</li><li>NOTE We recommend that you keep this check box as is (meaning to have all regions selected). The filter is exclusive regarding the regions selected. Any selection here means that only activities marked for those selected regions will arrive. Most activities do not note region and are reported globally, and so any specific selection will negate the arrival of global items. <br/></li></ul>
<!-- /wp:list -->

<!-- wp:heading -->
<h2>Chapter 8: Monitoring Identity and Access</h2>
<!-- /wp:heading -->

<!-- wp:list -->
<ul><li>This dashboard has a great summary of all identity-related activities monitored by Security Center. Security operations personnel should visit this dashboard multiple times throughout the day to quickly assess the current identity state. </li><li>Active Critical Notable Issues Notable issues are critical events. In the context of identity, they are critical identity events. This counter reflects the active notable issues that require immediate attention. </li><li>TIP For a complete list of logon failure reasons, see <a href="https://aka.ms/AccountLogon" target="_blank" rel="noopener">https://aka.ms/AccountLogon</a>.</li><li>When reviewing the Event 4625 window, pay close attention to the LogonTypeName field. If this field is set to 3, it means the logon attempt came from the network. In this case, you’ll also see an IPAddress field with the corresponding IP address. If LogonTypeName is set to 5, it means the logon attempt is coming from a service or process. A Process field will contain the process name. <br/></li></ul>
<!-- /wp:list -->

<!-- wp:heading -->
<h2>Chapter 9: Using Threat Intelligence To Identify Security Issues</h2>
<!-- /wp:heading -->

<!-- wp:list -->
<ul><li>Security Center leverages the Microsoft Threat Intelligence Center (MSTIC) to improve its detection capabilities, enhance its accuracy to avoid false positive alerts, and enable customers to make proactive cybersecurity decisions. </li><li>For threat intelligence to be useful, you need to draw from a large, diverse set of data and you must apply it to your processes and tools. </li><li>The data collected by Microsoft from these various sources passes through three phases. The first phase involves ensuring that data is used only in ways that Microsoft customers have agreed to. The data crosses this strict privacy/compliance boundary before entering the second phase: data collection and analysis.</li><li>Here the data is normalized, various analytics (machine learning, detonation, behavior) are applied to identify relevant security insights and findings, and the data is published to an internal API.</li><li>In the third phase, each product consumes this data, combs over it to uncover insight, and feeds these new insights back into the system to enrich other product findings. </li><li>Microsoft tracks an enormous number of threat actors, and each threat is handled by a virtual team. Products are instrumented to provide security-relevant data with privacy and compliance in mind. This data is used in analytics to identify abnormal behaviors. Security analysts perform investigations to understand the scope and scale of cyberthreats through log analysis, forensics, data mining, and detonation of malware samples. </li><li>TIP Visit <a href="https://youtu.be/QK3qxheUdBA" target="_blank" rel="noopener">https://youtu.be/QK3qxheUdBA</a> to watch a presentation delivered by co-author Yuri Diogenes at Ignite 2016 that demonstrates how to use the threat intelligence map in an investigation scenario. </li><li>TIP To simulate these security alerts in your own environment, follow the instructions in the Azure Security Center Security Incident Playbook, at <a href="https://aka.ms/ASCSecPlaybook" target="_blank" rel="noopener">https://aka.ms/ASCSecPlaybook</a></li><li>At the time of this writing, a feature called Virtual Analyst (VA) is in private preview. The goal of VA is to automate human analyst expert knowledge by generating a custom, rich entity based hunting graph for each security alert to extract meaningful insights. VA runs this online automated investigation on security alerts and assigns them confidence scores. A confidence score gives security operations personnel more (or less) confidence in the alert and helps them decide whether to move forward in the investigation. Confidence scores can also be used to help prioritize alerts and make risk assessments. <br/></li></ul>
<!-- /wp:list -->

<!-- wp:heading -->
<h2>Appendix A: Using Multiple Workspaces In Security Center</h2>
<!-- /wp:heading -->

<!-- wp:list -->
<ul><li>One scenario in which multiple workspaces are needed is when you need to isolate data—for example, if a company wants a separate workspace for each branch office. <br/></li></ul>
<!-- /wp:list -->

<!-- wp:heading -->
<h2>Appendix B: Customizing Your Operating System Security Baseline Assessment</h2>
<!-- /wp:heading -->

<!-- wp:list -->
<ul><li>Review the following considerations before making changes to the OS security configuration <ul><li><strong>Permission </strong>To perform this customization you need to belong to the Subscription Owner, Subscription Contributor, or Security Administrator role.</li><li><strong>Tier</strong> The customization capability is available only in the Security Center standard tier.</li><li><strong>Affected resources</strong> The customization applies to all virtual machines (VMs) and computers that are connected to all workspaces under the selected subscription. Plan carefully before making changes that will have a broad impact. </li><li><strong>Backup </strong>Before making changes to the original baseline policy, be sure to save the original baseline configuration file and keep it in a safe location for backup purposes. </li><li><strong>Planning </strong>Before making changes to the original baseline policy, be sure you plan which changes you want to make and why those changes are necessary to your environment. Also, be sure to align the business needs with the recommendations that you want to implement.</li></ul></li><li>Azure Security Center monitors security configurations by applying a set of more than 150 recommended rules for hardening the OS, including rules related to firewalls, auditing, password policies, and more. </li><li>Not all attributes are customizable. Only the following attributes can be changed:<ul><li><strong>expectedValue</strong> This attribute’s field data type must match the supported values per rule type. For example:<br/><ul><li><strong>baselineRegistryRules</strong> This value must match the regValueType defined in that rule. (See this article for more information about registry values types: <a href="https://aka.%20ms/registrytypevalue" target="_blank" rel="noopener">https://aka.</a><br/><a href="https://aka.%20ms/registrytypevalue" target="_blank" rel="noopener">ms/registrytypevalue</a>.)<br/></li><li><strong>baselineAuditPolicyRules</strong> Use one of the following supported string values for this value:<ul><li>Success and Failure</li><li>Success<br/></li></ul></li></ul></li><li><strong>baselineSecurityPolicyRules</strong> Use one of the following supported string values for this value:<ul><li>No one</li><li>Administrators, Backup, Operators, or any other values from the list of allowed user groups<br/></li></ul></li></ul></li><li><strong>state</strong> The string can contain the options Disabled or Enabled. In the preview release, the string was case-sensitive. Review the latest documentation (<a href="https://aka.ms/CustomOSSec" target="_blank" rel="noopener">https://aka.ms/CustomOSSec</a>) to confirm that this still applies.</li><li>When creating your own rules, comply with the following requirements: <ul><li>baselineId and baselineName can’t be changed.</li><li>A ruleset cannot be removed.</li><li>A ruleset cannot be added.</li><li>The maximum number of rules allowed (including default rules) is 1,000.</li><li>For registry rules, the hive must have LocalMachine.<br/></li><li>The originalId attribute can be null or empty. If it is not empty, it should be a valid GUID.<br/></li><li>The cceId attribute can be null or empty. If it is not empty, it must be unique.</li><li>The ruleType attribute can be Registry, AuditPolicy, or SecurityPolicy.<br/></li><li>The severity attribute can be Unknown, Critical, Warning, or Informational.<br/></li><li>The analyzeOperation attribute must be Equals.<br/></li><li>The auditPolicyId attribute must be a valid GUID.</li><li>The regValueType attribute can be Int, Long, String, or MultipleString</li></ul></li><li>To create a new rule, simply copy the entire block of an existing rule and paste it under the last rule or in between existing rules. </li><li>If it fails, you won’t be able to upload, and a red exclamation mark accompanied by a message that reads “Please upload a valid JSON configuration file” will appear. The error code will vary. To interpret the error code, see the “Error Code” section in this article: <a href="https://aka.ms/CustomOSSec" target="_blank">https://aka.ms/CustomOSSec</a>. <br/></li></ul>
<!-- /wp:list -->
